<div [style.background]="postsService.theme ? postsService.theme.background_color : null" style="width: 100%; height: 100%;">
  <div class="mat-elevation-z3" style="position: relative; z-index: 10;">
    <mat-toolbar class="sticky-toolbar top-toolbar">
      <div class="container-fluid" style="padding-left: 0px; padding-right: 0px">
        <div class="row" width="100%" height="100%">
          <div class="col-6" style="text-align: left; margin-top: 1px;">
            <div style="display: flex; align-items: center;">
              @if (router.url.split(';')[0] !== '/player') {
                <button #hamburgerMenu style="outline: none" mat-icon-button aria-label="Toggle side navigation" (click)="toggleSidenav()"><mat-icon>menu</mat-icon></button>
              } @else {
                <button (click)="goBack()" mat-icon-button><mat-icon>arrow_back</mat-icon></button>
              }
              <div style="margin-left: 8px; display: inline-block;"><button mat-icon-button routerLink='/home'><img style="width: 32px;" src="assets/images/logo_128px.png"></button></div>
            </div>
          </div>
          <div class="col-6" style="text-align: right; align-items: flex-end; display: inline-block">
            @if (postsService.config?.Extra.enable_notifications) {
              <button [matMenuTriggerFor]="notificationsMenu" (menuOpened)="notificationMenuOpened()" mat-icon-button>
                @if (notification_count > 0) {
                  <mat-icon [matBadge]="notification_count" matBadgeColor="warn" matBadgeSize="small">notifications</mat-icon>
                } @else {
                <mat-icon>notifications_none</mat-icon>
              }</button>
            }
            <mat-menu [classList]="'notifications-menu'" (close)="notificationMenuClosed()" #notificationsMenu="matMenu">
              <app-notifications #notifications (notificationCount)="notificationCountUpdate($event)" (click)="$event.stopPropagation()"></app-notifications>
            </mat-menu>
            <button [matMenuTriggerFor]="menuSettings" mat-icon-button><mat-icon>more_vert</mat-icon></button>
            <mat-menu #menuSettings="matMenu">
              <button class="top-menu-button" (click)="openProfileDialog()" mat-menu-item>
                <mat-icon>person</mat-icon>
                <span i18n="Profile menu label">Profile</span>
              </button>
              @if (!postsService.config?.Advanced.multi_user_mode || postsService.isLoggedIn) {
                <button class="top-menu-button" (click)="openArchivesDialog()" mat-menu-item>
                  <mat-icon>topic</mat-icon>
                  <span i18n="Archives menu label">Archives</span>
                </button>
              }
              @if (allowThemeChange) {
                <button class="top-menu-button" (click)="themeMenuItemClicked($event)" mat-menu-item>
                  <mat-icon>{{(postsService.theme.key === 'default') ? 'brightness_5' : 'brightness_2'}}</mat-icon>
                  <span i18n="Dark mode toggle label">Dark</span>
                  <mat-slide-toggle class="theme-slide-toggle" [checked]="postsService.theme.key === 'dark'"></mat-slide-toggle>
                </button>
              }
              <button class="top-menu-button" (click)="openAboutDialog()" mat-menu-item>
                <mat-icon>info</mat-icon>
                <span i18n="About menu label">About</span>
              </button>
            </mat-menu>
          </div>
        </div>
      </div>
    </mat-toolbar>
  </div>
  <div class="sidenav-container" style="height: calc(100% - 64px)">
    <mat-sidenav-container style="height: 100%">
      <mat-sidenav [opened]="postsService.sidepanel_mode === 'side' && !window.location.href.includes('/player')" [mode]="postsService.sidepanel_mode" #sidenav>
        <mat-nav-list>
          @if (postsService.config && (!postsService.config.Advanced.multi_user_mode || postsService.isLoggedIn)) {
            <a mat-list-item (click)="postsService.sidepanel_mode === 'over' ? sidenav.close() : null" routerLink='/home'><ng-container i18n="Navigation menu Home Page title">Home</ng-container></a>
          }
          @if (postsService.config && postsService.config.Advanced.multi_user_mode && !postsService.isLoggedIn) {
            <a mat-list-item (click)="sidenav.close()" routerLink='/login'><ng-container i18n="Navigation menu Login Page title">Login</ng-container></a>
          }
          @if (postsService.config && allowSubscriptions && postsService.hasPermission('subscriptions')) {
            <a mat-list-item (click)="postsService.sidepanel_mode === 'over' ? sidenav.close() : null" routerLink='/subscriptions'><ng-container i18n="Navigation menu Subscriptions Page title">Subscriptions</ng-container></a>
          }
          @if (postsService.config && enableDownloadsManager && postsService.hasPermission('downloads_manager')) {
            <a mat-list-item (click)="postsService.sidepanel_mode === 'over' ? sidenav.close() : null" routerLink='/downloads'><ng-container i18n="Navigation menu Downloads Page title">Downloads</ng-container></a>
          }
          @if (postsService.config && postsService.hasPermission('tasks_manager')) {
            <a mat-list-item (click)="postsService.sidepanel_mode === 'over' ? sidenav.close() : null" routerLink='/tasks'><ng-container i18n="Navigation menu Tasks Page title">Tasks</ng-container></a>
          }
          @if (postsService.config && postsService.hasPermission('settings')) {
            <mat-divider></mat-divider>
            <a mat-list-item (click)="postsService.sidepanel_mode === 'over' ? sidenav.close() : null" routerLink='/settings'><ng-container i18n="Settings menu label">Settings</ng-container></a>
          }
          @if (postsService.config && allowSubscriptions && postsService.subscriptions && postsService.hasPermission('subscriptions')) {
            @if (postsService.subscriptions.length > 0) {
              <mat-divider></mat-divider>
            }
            @for (subscription of postsService.subscriptions; track subscription) {
              <a mat-list-item (click)="postsService.sidepanel_mode === 'over' ? sidenav.close() : null" [routerLink]="['/subscription', { id: subscription.id }]"><ngx-avatars [style.display]="'inline-block'" [style.margin-right]="'10px'" size="32" [name]="subscription.name"></ngx-avatars>{{subscription.name}}</a>
            }
          }
        </mat-nav-list>
      </mat-sidenav>
      <mat-sidenav-content [style.background]="postsService.theme ? postsService.theme.background_color : null">
        <router-outlet></router-outlet>
      </mat-sidenav-content>
    </mat-sidenav-container>
  </div>
</div>